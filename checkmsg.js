const $ = new Env('Rtool检测信息');
var _0xodQ='jsjiami.com.v6',_0xodQ_=['_0xodQ'],_0x1477=[_0xodQ,'DR8ycVjDoAc=','EcO1CQ==','XX0uw73DmsO1IQpvw69kE+WEoeaIsuWKn3A=','wqPku4notITljY3DgsKtwp1TbcOaMMOZw4gvw5I=','MMOjAX1GTRY=','wp8Tw4PCrQ==','OsOAw4/DvcKn','NHkEw45K','RcOVw4nCrHY=','wqvCscK8w7DDjg==','w6hJwq4gw7U=','EQTCtMOMNzZFwpjCs8KmFcOVAMKGw5XCoVLDi8KWw6LDkTlXw6ZFwo02w4Y+fl0Nw5vCoHXDgsKpwp0mRjYSd8OCDybDvsKywoLCtCDDsEtRMmF9w55Mw5NA','wojCocKcfcO7AzXDl8KWd8OKwpA2Pw==','OMOvwrzDlcOt','PBPDoQ==','w6vCmcKlw4LDmA==','GMKcwqXCvcK1','w4MfwoBcMMK4woc=','OBbCswcB','w5vCjcKxw6DDkw==','MsOSPHhE','w4F3S2wG','woYEw5XCgQ==','JMOrwqDDgcO8dg==','w6lHwr0=','w4/orLvmibTlkrHoo77moqPlkavmn70=','AjDDkhPCmw==','KMOYw4bDl8KLwp1uwpTCgcK1','w7VhBsKUdFU2w55F','w6vCpsO8','6K6E6KGz5qGm5pen5o+45Yqy5YiU5pq1776L','wrXDujHCjw==','ZcO5OA==','a+WPuOS6vuS6re++jA==','w5pbIsK3Vw==','J8Kmwo3CmMK6','DTh3wo7Cjw==','TBbDmEFo','LwPDssORAg==','KBnDp8OtAA==','ZsOjNU3DuQ==','LGDDmMOebijCvg==','FyfCsQUu','AG0sX8O4wrtF','HAtXwqPCoA==','w43Dui7DmW0=','NXvDj8OT','KwPDpiM=','w4wewpZ8KcKUwok=','EsOQNC3Cog==','Hx/CssO5JW8C','QcO3wr5Gwro=','wqkZw6vCug8=','w4/DqcKlc1Y=','w6N9EMKQ','SzDDoGhf','McKswokfZQ==','w59ubsKXwpRMw7DCjA==','I2DDvw==','ZuisiOaJrOWTtuiileaih+WQguactA==','wqpPwok=','6Kyg6KK25qOt5peM5o+45YqZ5Ymr5pub776q','wqTCrMKDwqU=','JMOhwqk=','w6FvwpAww6o=','NCXChy8K','LSXDtcOV','w4/CoMKRw6w=','w6DDpD7DjlE=','L8K+wokiTg==','fA7Dmg0J','w6HDgRHDo1oDwqnCvRrDjQ==','KWHDmw==','w5HCsMKPw6E=','DeaetOWikeWGnOWMs+mHgcOa','NFcXw45KFcKb','UMO7wo5hwop6wps=','wpfCisK+w5PDusO3JA==','P8O5IXNORA==','ZEoXwqHChkzDog==','HV9wG8K+BQ==','dkEHwqDCgVHDrV/Dvg==','w5VyScK4woc=','wrYGw43CjcKs','wojDlT/ClsKS','Bx8n','wqcBIsO1w4AfwqvDnsKmXsKaE8KXBTozw75xd0rDvTUrwrZow47Dt8KFwqbCh8OBw69ow6sIwr1BaGXCiWkMwpHCgsKvwo3CscKowojDmuiFkeacneaJh+ihpRRew5nljrzkuKXmlZrplYvCj8Otwq3Coj4Nw7/vvY0=','AMK+woPCgsKl','w6fDg8KrcU8Mwpc=','XXUiAS8=','BSnCiz8iWsO9w6k6GBPCkhYCw7/CkcKi','D0oMw5/Drg==','w5rCr8KzccO9ESrDrcKxbMOTwpw2ZQ==','wqDCm8OiGBtcw49Gw4Vww4HDqcKMfw5SJETDjUTDksKpwq3DhMOmw5EMH3XDjBJlw7hfwp0IQsKPwqfDkB1Xw4IaQcOKOsO3wpo=','w5rCrsKLMcOi','wpcTw4o=','V23Cu8KAUk3DjETDlcONwoIQ5YW55omj5YmhGQ==','w4FkeA==','6L6E5pm/5L+m55i56LWJ5Y6H5paB57q9w5LDusKf','wqgdw4HCgwg=','worChsKEw4jDvQ==','LiDDqsOUGw==','yOjsHjTyWiWutamGi.com.fQzv6Sn=='];if(function(_0x566469,_0x34a51b,_0x12e638){function _0x4ed35d(_0x30e6ec,_0x3111c3,_0x389510,_0x52e927,_0x5726bc,_0x43805d){_0x3111c3=_0x3111c3>>0x8,_0x5726bc='po';var _0x516d94='shift',_0x5c8ec6='push',_0x43805d='0.tlel5ziyqns';if(_0x3111c3<_0x30e6ec){while(--_0x30e6ec){_0x52e927=_0x566469[_0x516d94]();if(_0x3111c3===_0x30e6ec&&_0x43805d==='0.tlel5ziyqns'&&_0x43805d['length']===0xd){_0x3111c3=_0x52e927,_0x389510=_0x566469[_0x5726bc+'p']();}else if(_0x3111c3&&_0x389510['replace'](/[yOHTyWWutGfQzSn=]/g,'')===_0x3111c3){_0x566469[_0x5c8ec6](_0x52e927);}}_0x566469[_0x5c8ec6](_0x566469[_0x516d94]());}return 0x115a14;};return _0x4ed35d(++_0x34a51b,_0x12e638)>>_0x34a51b^_0x12e638;}(_0x1477,0x1e3,0x1e300),_0x1477){_0xodQ_=_0x1477['length']^0x1e3;};function _0x15d8(_0x326b86,_0x5c7ca7){_0x326b86=~~'0x'['concat'](_0x326b86['slice'](0x0));var _0x2a0627=_0x1477[_0x326b86];if(_0x15d8['alNOKn']===undefined){(function(){var _0x52ffa7;try{var _0x3215cb=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x52ffa7=_0x3215cb();}catch(_0xdb231c){_0x52ffa7=window;}var _0x340ee8='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x52ffa7['atob']||(_0x52ffa7['atob']=function(_0x200aa5){var _0x2e7d5b=String(_0x200aa5)['replace'](/=+$/,'');for(var _0x50aa2a=0x0,_0x15fada,_0x30f71e,_0x5e18e2=0x0,_0x2ce934='';_0x30f71e=_0x2e7d5b['charAt'](_0x5e18e2++);~_0x30f71e&&(_0x15fada=_0x50aa2a%0x4?_0x15fada*0x40+_0x30f71e:_0x30f71e,_0x50aa2a++%0x4)?_0x2ce934+=String['fromCharCode'](0xff&_0x15fada>>(-0x2*_0x50aa2a&0x6)):0x0){_0x30f71e=_0x340ee8['indexOf'](_0x30f71e);}return _0x2ce934;});}());function _0x2577ad(_0x5b2623,_0x5c7ca7){var _0x3c185a=[],_0x8e8849=0x0,_0x9f4a1,_0x2d816d='',_0x3ba273='';_0x5b2623=atob(_0x5b2623);for(var _0x1535fb=0x0,_0x574345=_0x5b2623['length'];_0x1535fb<_0x574345;_0x1535fb++){_0x3ba273+='%'+('00'+_0x5b2623['charCodeAt'](_0x1535fb)['toString'](0x10))['slice'](-0x2);}_0x5b2623=decodeURIComponent(_0x3ba273);for(var _0x52318e=0x0;_0x52318e<0x100;_0x52318e++){_0x3c185a[_0x52318e]=_0x52318e;}for(_0x52318e=0x0;_0x52318e<0x100;_0x52318e++){_0x8e8849=(_0x8e8849+_0x3c185a[_0x52318e]+_0x5c7ca7['charCodeAt'](_0x52318e%_0x5c7ca7['length']))%0x100;_0x9f4a1=_0x3c185a[_0x52318e];_0x3c185a[_0x52318e]=_0x3c185a[_0x8e8849];_0x3c185a[_0x8e8849]=_0x9f4a1;}_0x52318e=0x0;_0x8e8849=0x0;for(var _0x5c8d7f=0x0;_0x5c8d7f<_0x5b2623['length'];_0x5c8d7f++){_0x52318e=(_0x52318e+0x1)%0x100;_0x8e8849=(_0x8e8849+_0x3c185a[_0x52318e])%0x100;_0x9f4a1=_0x3c185a[_0x52318e];_0x3c185a[_0x52318e]=_0x3c185a[_0x8e8849];_0x3c185a[_0x8e8849]=_0x9f4a1;_0x2d816d+=String['fromCharCode'](_0x5b2623['charCodeAt'](_0x5c8d7f)^_0x3c185a[(_0x3c185a[_0x52318e]+_0x3c185a[_0x8e8849])%0x100]);}return _0x2d816d;}_0x15d8['rUmiwO']=_0x2577ad;_0x15d8['mMDFYI']={};_0x15d8['alNOKn']=!![];}var _0x152b81=_0x15d8['mMDFYI'][_0x326b86];if(_0x152b81===undefined){if(_0x15d8['xShqCT']===undefined){_0x15d8['xShqCT']=!![];}_0x2a0627=_0x15d8['rUmiwO'](_0x2a0627,_0x5c7ca7);_0x15d8['mMDFYI'][_0x326b86]=_0x2a0627;}else{_0x2a0627=_0x152b81;}return _0x2a0627;};let RToolurl=$[_0x15d8('0','KxTj')]('RToolurl');let RToolhd=$[_0x15d8('1','mgBF')](_0x15d8('2','obMu'));let _eid='';let Rtoken=($[_0x15d8('3','kZ4p')]()?process['env']['Rtoken']:$[_0x15d8('4','oNwi')](_0x15d8('5','EU4E')))||'';let _referer='';let RtokenArr='';let getmsgArr='';let msg_field_name=[];let msg_field_key=[];let msg_field_value=[];!(async()=>{var _0x138cda={'BkpsJ':function(_0x8c8df1,_0x261fb5){return _0x8c8df1!==_0x261fb5;},'Tclmk':_0x15d8('6','oNwi'),'YNzxK':function(_0x42c8a4){return _0x42c8a4();},'lSJyX':function(_0x3af834,_0x314f99){return _0x3af834+_0x314f99;},'lZGGb':function(_0x3f58c3,_0x36e718){return _0x3f58c3*_0x36e718;},'oBpRh':function(_0x2b15dc,_0x2926f2){return _0x2b15dc*_0x2926f2;},'nQVHx':function(_0x2d865e,_0x3f0ab8){return _0x2d865e*_0x3f0ab8;},'Nzcji':'Rtoken','SalKj':function(_0x426471){return _0x426471();},'qPVsF':function(_0x60c4fd,_0x331703){return _0x60c4fd<_0x331703;},'OXUtk':_0x15d8('7','[R7s'),'EGlZe':function(_0x440d27,_0x459238){return _0x440d27+_0x459238;}};if(_0x138cda['BkpsJ'](typeof $request,_0x138cda[_0x15d8('8','%fUD')])){RToolck();_0x138cda[_0x15d8('9','go1@')](RTck);}else{console[_0x15d8('a','bR%n')](_0x15d8('b','[R7s')+new Date(_0x138cda[_0x15d8('c','zY@D')](new Date()[_0x15d8('d','V]o#')]()+_0x138cda[_0x15d8('e','gTWd')](_0x138cda['oBpRh'](new Date()[_0x15d8('f','nPJ9')](),0x3c),0x3e8),_0x138cda['nQVHx'](_0x138cda[_0x15d8('10','HmLb')](0x8,0x3c)*0x3c,0x3e8)))[_0x15d8('11','g94D')]()+_0x15d8('12','V]o#'));RtokenArr=await checkEnv(Rtoken,_0x138cda[_0x15d8('13','Dj7W')]);console[_0x15d8('14','o!s4')](_0x15d8('15','(8b]')+RtokenArr['length']+'\x20个账号\x20==========');console[_0x15d8('16','[R7s')](_0x15d8('17','(8b]')+RtokenArr);await _0x138cda[_0x15d8('18','o!s4')](getkey);for(let _0xa0a349=0x0;_0x138cda['qPVsF'](_0xa0a349,0x1);_0xa0a349++){if(_0x138cda[_0x15d8('19','obMu')]==='RUhWJ'){ck[_0x15d8('1a','(8b]')]('@')[_0x15d8('1b','bR%n')](_0x2d7b01=>{ckArr['push'](_0x2d7b01);});}else{let _0x20a39e=_0x138cda['EGlZe'](_0xa0a349,0x1);console[_0x15d8('1c','ts8@')](_0x15d8('1d','R5&l')+_0x20a39e+_0x15d8('1e','(*7v'));Rtoken=RtokenArr[_0xa0a349];}}}})()['catch'](_0x23036d=>$['logErr'](_0x23036d))[_0x15d8('1f','kZ4p')](()=>$[_0x15d8('20','o!s4')]());function getkey(_0x5420e1=0x0){var _0x584d22={'uuWWI':function(_0x230d5d){return _0x230d5d();},'EXZPy':function(_0x2782c4,_0x2cf247){return _0x2782c4!==_0x2cf247;},'Ahvqh':_0x15d8('21',']a^7'),'nomLX':_0x15d8('22','KxTj')};return new Promise(_0x916db2=>{var _0x46e5fd={'ISAOG':function(_0x5dbfc4){return _0x584d22[_0x15d8('23','UWbC')](_0x5dbfc4);},'SzXOw':function(_0x1a4aa8,_0x174bf5){return _0x584d22['EXZPy'](_0x1a4aa8,_0x174bf5);},'TLGFe':_0x584d22['Ahvqh'],'ZZLlJ':function(_0x4a8334,_0x396311){return _0x4a8334===_0x396311;},'dXSdn':_0x584d22[_0x15d8('24','obMu')],'YFGXA':function(_0x178e64,_0x4a4602){return _0x178e64<_0x4a4602;}};_eid=RToolurl[_0x15d8('25','5z6B')](/eid=(.*?)&/)[0x1];let _0x1f460f={'url':_0x15d8('26','zq0u')+_eid+_0x15d8('27','g94D')+RtokenArr[0x0]+'&admin=0&from=detail&referer=','headers':JSON[_0x15d8('28','nheI')](RToolhd)};$[_0x15d8('29','*DIH')](_0x1f460f,async(_0x2c9d9e,_0x1fbbef,_0x1dc40a)=>{if(_0x46e5fd['SzXOw'](_0x46e5fd[_0x15d8('2a','ya]x')],_0x15d8('2b','zY@D'))){ck['split']('\x0a')[_0x15d8('2c','Rsm^')](_0x4eb3a2=>{ckArr['push'](_0x4eb3a2);});}else{try{if(_0x46e5fd[_0x15d8('2d','nPJ9')](_0x46e5fd[_0x15d8('2e','ya]x')],_0x46e5fd[_0x15d8('2f','kZ4p')])){_0x1dc40a=JSON[_0x15d8('30','jMzS')](_0x1dc40a);let _0x20646e=_0x1dc40a[_0x15d8('31','%fUD')]['req_info'];getmsgArr=_0x20646e[_0x15d8('32','nheI')];console[_0x15d8('33','5z6B')](_0x15d8('34','obMu')+getmsgArr+'条数据~');for(let _0xdc3cf3=0x0;_0x46e5fd[_0x15d8('35','*DIH')](_0xdc3cf3,getmsgArr);_0xdc3cf3++){msg_field_name[_0xdc3cf3]=_0x20646e[_0xdc3cf3][_0x15d8('36',']a^7')];msg_field_key[_0xdc3cf3]=_0x20646e[_0xdc3cf3][_0x15d8('37','FkWh')];}console[_0x15d8('38',')WH#')](_0x15d8('39','HmLb')+msg_field_name);let _0x386366=_0x1dc40a[_0x15d8('3a','go1@')]['token'];console[_0x15d8('3b','TiL)')](_0x15d8('3c','HmLb')+_0x386366);}else{_0x46e5fd['ISAOG'](RToolck);_0x46e5fd['ISAOG'](RTck);}}catch(_0xf6cd55){}finally{_0x46e5fd[_0x15d8('3d','FkWh')](_0x916db2);}}},_0x5420e1);});}async function checkEnv(_0x34c2f2,_0x4e43f6){var _0x11babd={'nZWGq':function(_0x2c93a4,_0x2f45bf){return _0x2c93a4===_0x2f45bf;},'JRZVS':_0x15d8('3e','zY@D'),'CYKvg':'xthSi','iQFnI':_0x15d8('3f','R5&l'),'oujYy':function(_0x319e41,_0x4aebd1){return _0x319e41!==_0x4aebd1;},'FOshI':_0x15d8('40','UaWQ'),'gLJAo':function(_0x28d185,_0x13b11f){return _0x28d185(_0x13b11f);},'nsrNN':'qZZyW','jpjPI':_0x15d8('41','jkhq')};return new Promise(_0x2157d4=>{var _0x5b2c13={'viDCQ':function(_0x37ab6e){return _0x37ab6e();},'ReFrm':_0x11babd['CYKvg'],'OOzVp':_0x11babd[_0x15d8('42','jkhq')]};let _0x2e8dec=[];if(_0x34c2f2){if(_0x11babd[_0x15d8('43','TiL)')](_0x34c2f2[_0x15d8('44','Mh^1')]('@'),-0x1)){if(_0x11babd['oujYy'](_0x11babd['FOshI'],_0x15d8('45','nPJ9'))){_0x2e8dec['push'](item);}else{_0x34c2f2['split']('@')[_0x15d8('46','V61p')](_0x5e0f1b=>{if(_0x11babd['nZWGq'](_0x15d8('47','R5&l'),_0x11babd[_0x15d8('48','s!eH')])){_0x2e8dec[_0x15d8('49','Mh^1')](_0x5e0f1b);}else{_0x2e8dec[_0x15d8('4a','*DIH')](_0x5e0f1b);}});}}else if(_0x34c2f2[_0x15d8('4b','Rsm^')]('\x0a')!==-0x1){if('whJRm'!==_0x15d8('4c','ts8@')){_0x34c2f2['split']('\x0a')[_0x15d8('4d','zq0u')](_0x5292a6=>{var _0xf7278f={'rMvGR':function(_0x1fbc97){return _0x5b2c13[_0x15d8('4e','mgBF')](_0x1fbc97);}};if(_0x5b2c13[_0x15d8('4f','o!s4')]!==_0x5b2c13[_0x15d8('50','V]o#')]){_0x2e8dec[_0x15d8('51','FkWh')](_0x5292a6);}else{_0xf7278f[_0x15d8('52','UaWQ')](_0x2157d4);}});}else{data=JSON[_0x15d8('53','a#M4')](data);let _0xcdaf51=data['data'][_0x15d8('54','[R7s')];getmsgArr=_0xcdaf51['length'];console[_0x15d8('55','&gDU')](_0x15d8('56','zY@D')+getmsgArr+'条数据~');for(let _0x1715e7=0x0;_0x1715e7<getmsgArr;_0x1715e7++){msg_field_name[_0x1715e7]=_0xcdaf51[_0x1715e7]['field_name'];msg_field_key[_0x1715e7]=_0xcdaf51[_0x1715e7]['field_key'];}console[_0x15d8('57','rx[o')](_0x15d8('58','obMu')+msg_field_name);let _0x2beca8=data[_0x15d8('59','XRHv')]['token'];console[_0x15d8('5a','nheI')]('\x0a口令为：'+_0x2beca8);}}else{if(_0x11babd['nZWGq'](_0x15d8('5b','5z6B'),_0x15d8('5c','nPJ9'))){_0x2e8dec[_0x15d8('5d','(8b]')](_0x34c2f2);}else{_0x2e8dec[_0x15d8('5e','ya]x')](_0x34c2f2);}}_0x11babd[_0x15d8('5f','s!eH')](_0x2157d4,_0x2e8dec);}else{if(_0x11babd[_0x15d8('60','a#M4')]===_0x11babd[_0x15d8('61','tNcA')]){msg_field_name[i]=getmsg[i][_0x15d8('62','s!eH')];msg_field_key[i]=getmsg[i][_0x15d8('37','FkWh')];}else{console[_0x15d8('63','Mh^1')]('\x20'+$[_0x15d8('64','ya]x')]+_0x15d8('65','mgBF')+_0x4e43f6+'\x20,请仔细阅读脚本说明!');}}});};_0xodQ='jsjiami.com.v6';
function Env(t, e) { class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `\ud83d\udd14${this.name}, \u5f00\u59cb!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), a = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(a, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t) { let e = { "M+": (new Date).getMonth() + 1, "d+": (new Date).getDate(), "H+": (new Date).getHours(), "m+": (new Date).getMinutes(), "s+": (new Date).getSeconds(), "q+": Math.floor(((new Date).getMonth() + 3) / 3), S: (new Date).getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, ((new Date).getFullYear() + "").substr(4 - RegExp.$1.length))); for (let s in e) new RegExp("(" + s + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? e[s] : ("00" + e[s]).substr(("" + e[s]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))); let h = ["", "==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="]; h.push(e), s && h.push(s), i && h.push(i), console.log(h.join("\n")), this.logs = this.logs.concat(h) } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t.stack) : this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }