const $ = new Env('Rtool检测信息');
var _0xodc='jsjiami.com.v6',_0xodc_=['_0xodc'],_0x5dc7=[_0xodc,'DcKMw7Rtw78Fw4Y/wqoE','wrZpw4lyWjZHA8K+','OMK5woQ=','6K2F6KG25qGq5pee5o6M5YuO5Yim5pu5772T','w7M1wr/CkA==','w6ldwp4xPw==','cMO3wrg=','HOWPouS7h+S7tO+/uw==','w5zCpmJGCw==','AHBiwpkQ','RcK9wooDUw==','Y31YwpzChA==','WcO9wrXDrsO0','QhHDsMODw5E=','w4c8Wlc=','BsKQSTBQ','XMKzw5VdQBPCmA==','wqRqNcOfKw==','EyzCiMOkw7V+w7k=','wqYrwpXDuQ==','wr3DssK3GcKkwofDiA==','w4Q5RVYT','wrZvw55bXwpE','NkcFXw==','WUDDhcOJwok=','RcOswrjDlsO6','wqTDqcKgFA==','w5JSM8OLwo0=','PMKkZcK/XQ==','CFdI','IMKDXcKY','Q+aegOWikOWGoeWPh+mHu8K2','wr3Ct+isseS4sOe7sumanuisjeiGg+aequisq+aamRg=','PMKmwoQECw==','esO3wq3DnMOsw7c2','w6chwrjCmQ==','TAfDgsOQw7nCvsKP','woRiJGs1GMK4NA==','HsOPwo9cfkDDtw==','woQKwonDvgPCvE0=','YX1fwrrCi00=','ZVrDlA==','woQqwonDugrCug==','IVcCU8OUB8On','woRCJG88Aw==','wqJ0PcOTOSdfWnE=','X8KCwqoafQ==','wpnDt8KrDsKE','cEt7w5hX','wqNAw53CnsOU','NsO9wpJQdQ==','AsK9wpAfJw==','BjPDgMKVw6E=','IsKJVw==','RsK7woLCuFs1wpI5HMOzwpg65Yez5oit5Yijwq0=','BuS6qei1qeWPpsK1w4Vaw69hwp3DsRLCj8OjWQ==','FG1D','EsK9AsOWw716w4Rxw4xaw4BCbcOtw6s1HT/DnsOaw7s0IVUoEDBeYT5nScOba8KDwrzDmcOww6BfwpjCsmjDn2HDjzwDSi7oh7/mnZPmib3ooJbCmMKOO+WOl+S6juaXiOmVhMOxw6vChsOfw4TDsmrvvr8=','w6gLw4DChEnDj3A=','w6DCncKWwqHDmA==','w7rDvsKywrBdw7bCk8Ojw6nCscOydhRTSsKHw48=','HcKNw6lCw7w=','w6tawo0XNg==','wrwGw7jCvcKd','wqU7w4bDo8Kww5d0w6INw7VYNTfDhA==','w4tEJTfDssKdXMOAw5HDqMKKw6dtYSDDpnXDtcKjU8KQwoHDnCMWTMKFPXlwbTZCwoLDnyvDncKMw7PChMKjwq5rwr9Tw4skw5TDjA==','wo04bmXCiA==','K8OswojDn8KlDQ==','XsOrw57CgcKhw4XCnl4xWcKBwq3lhqHmiJnlialE','cMO9wrHDvsO5w7w=','VeS5qei3nOWNlsK0IMKsW8KpIEDCmzXClBA=','dMOYWA==','6L2g5pq45L+F55qZ6La25Yyv5pSD57mcL0rCoQ==','H8OrG8KRRg==','OsOOw5bDnBw=','woJtEMO7KQ==','Q3ZqwoPClw==','w4nDtsOXbsO1','KsOmwrhqcg==','wrnDr8K0','w6YAw4LCsUzDi3Erwo/CkcKZFHwbdnosEEPClA==','wo0Aw6g=','w5sgw6XDp8K2w5jlpKnml48=','woUOw7vCmw==','w4UsWGAOw5/DicKl','UTl3wovDv8K0','Xuiss+aJhuWSseijtOajhOWSiOadqg==','5p+W5pa+5o6xw6g=','X1pQwqfCqA==','GBPDksKuw6TDq8KOwpN8w4A=','wpcLUTJgw4vCkA7DjA==','w7FdwpI=','6K2S6KCh5qCV5pWP5oyJ5Yq35YqE5pul772F','QsOiO3A=','STNywonDpQ==','wrxvw4s=','w5zlj5Xkuq/kuL7vvYM=','FExHwrE7','w5smTg==','w5o9wpEjA1QRW8O6wrfDsMKx5Yas5oux5Yi6Gw==','POS6sui3ueWNrsKtwqljecOuwpvCt8KMwrp2w7o=','CMKEw6Viw7M=','dMOYWMKuwrI1','KcK/woYME8Oaw6g=','cm5Nwqs=','RMOKwp3DvcO9','wr3DssKlHcKwwqHDisK+KcKRw5g0w5tacCnCicKBw5ZN','wqQ1WjJq','w7TCl39oGw==','LMK/wo46CQ==','wpsRw6HDgsKm','woMUwq7Dvj0=','Vm5Gw71N','wpM+f8Kd','CVlbwrM5','fnVXwr7CklYuwpPCosKNwq/DicOmw4EGHwvDv1bCv2/Cr0XDq0weasOBYnnCs8Kow6Bnw4Ixw7QEJsK/wobDnMK0cm7CvcOswqh2MxZJTcO3wq/CjMKkw5PCnS3CuQ==','OsO5wrzDusOow6ctG8Knw4nDocOUw6l2','w7A/woLDvAbCuhRNMsOlw6jCtnYLSMKOwoxwccOmcMOaZBZJwrJgw49Y','wpsWw4bCpMKZ','wrYxw74=','w7hMFMOKwpI=','wppUH2c+','w5XCpcKTwpnDlg==','Hm1WTcKWWmY=','YMKvwpsZ','w4ZyBjTCqA==','EcOTwo11UA==','ZX12','w7HDlsKpwqxC','w5bDusKowoBx','P0poecKe','wrR0w4XCgcO0','bXfDrMOWwrM=','LsKYWipz','w5p8Ew==','RsOyw5DDrgNm5aae5pWM','w7nDusKywoU=','PcKzwpkyFsOYw7fCiw==','w4x7OMOJwpbCoA==','Rw3DkQ==','wp3orrHmia7lk7zoo5jmoL7lkpfmnZk=','5pyU5pSz5o6Uw58=','wqsGw6zCs8O0','hyILjshjiRMeaeWZmi.hXWcBom.v6=='];if(function(_0x2d8f05,_0x4b81bb,_0x4d74cb){function _0x32719f(_0x2dc776,_0x362d54,_0x2576f4,_0x5845c1,_0x4fbc7a,_0x6c88bf){_0x362d54=_0x362d54>>0x8,_0x4fbc7a='po';var _0x151bd2='shift',_0x558098='push',_0x6c88bf='0.v7qhjg6v0d';if(_0x362d54<_0x2dc776){while(--_0x2dc776){_0x5845c1=_0x2d8f05[_0x151bd2]();if(_0x362d54===_0x2dc776&&_0x6c88bf==='0.v7qhjg6v0d'&&_0x6c88bf['length']===0xc){_0x362d54=_0x5845c1,_0x2576f4=_0x2d8f05[_0x4fbc7a+'p']();}else if(_0x362d54&&_0x2576f4['replace'](/[hyILhRMeeWZhXWB=]/g,'')===_0x362d54){_0x2d8f05[_0x558098](_0x5845c1);}}_0x2d8f05[_0x558098](_0x2d8f05[_0x151bd2]());}return 0x115a1e;};return _0x32719f(++_0x4b81bb,_0x4d74cb)>>_0x4b81bb^_0x4d74cb;}(_0x5dc7,0x1d1,0x1d100),_0x5dc7){_0xodc_=_0x5dc7['length']^0x1d1;};function _0x4603(_0x179519,_0x308b10){_0x179519=~~'0x'['concat'](_0x179519['slice'](0x0));var _0x129f12=_0x5dc7[_0x179519];if(_0x4603['ftYpLZ']===undefined){(function(){var _0x4af041=function(){var _0x1a224c;try{_0x1a224c=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x42c91a){_0x1a224c=window;}return _0x1a224c;};var _0x487a63=_0x4af041();var _0x52aa96='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x487a63['atob']||(_0x487a63['atob']=function(_0x581f2d){var _0x50d248=String(_0x581f2d)['replace'](/=+$/,'');for(var _0x3494ec=0x0,_0x308388,_0x417c99,_0x402d9c=0x0,_0x404216='';_0x417c99=_0x50d248['charAt'](_0x402d9c++);~_0x417c99&&(_0x308388=_0x3494ec%0x4?_0x308388*0x40+_0x417c99:_0x417c99,_0x3494ec++%0x4)?_0x404216+=String['fromCharCode'](0xff&_0x308388>>(-0x2*_0x3494ec&0x6)):0x0){_0x417c99=_0x52aa96['indexOf'](_0x417c99);}return _0x404216;});}());function _0x53ed7e(_0x34fc6c,_0x308b10){var _0x2944c4=[],_0xda3913=0x0,_0x299a54,_0x196c3f='',_0x28debc='';_0x34fc6c=atob(_0x34fc6c);for(var _0x46295c=0x0,_0x126192=_0x34fc6c['length'];_0x46295c<_0x126192;_0x46295c++){_0x28debc+='%'+('00'+_0x34fc6c['charCodeAt'](_0x46295c)['toString'](0x10))['slice'](-0x2);}_0x34fc6c=decodeURIComponent(_0x28debc);for(var _0x1fcb64=0x0;_0x1fcb64<0x100;_0x1fcb64++){_0x2944c4[_0x1fcb64]=_0x1fcb64;}for(_0x1fcb64=0x0;_0x1fcb64<0x100;_0x1fcb64++){_0xda3913=(_0xda3913+_0x2944c4[_0x1fcb64]+_0x308b10['charCodeAt'](_0x1fcb64%_0x308b10['length']))%0x100;_0x299a54=_0x2944c4[_0x1fcb64];_0x2944c4[_0x1fcb64]=_0x2944c4[_0xda3913];_0x2944c4[_0xda3913]=_0x299a54;}_0x1fcb64=0x0;_0xda3913=0x0;for(var _0x43ed0a=0x0;_0x43ed0a<_0x34fc6c['length'];_0x43ed0a++){_0x1fcb64=(_0x1fcb64+0x1)%0x100;_0xda3913=(_0xda3913+_0x2944c4[_0x1fcb64])%0x100;_0x299a54=_0x2944c4[_0x1fcb64];_0x2944c4[_0x1fcb64]=_0x2944c4[_0xda3913];_0x2944c4[_0xda3913]=_0x299a54;_0x196c3f+=String['fromCharCode'](_0x34fc6c['charCodeAt'](_0x43ed0a)^_0x2944c4[(_0x2944c4[_0x1fcb64]+_0x2944c4[_0xda3913])%0x100]);}return _0x196c3f;}_0x4603['bLSJOI']=_0x53ed7e;_0x4603['LarsXy']={};_0x4603['ftYpLZ']=!![];}var _0x4f9c11=_0x4603['LarsXy'][_0x179519];if(_0x4f9c11===undefined){if(_0x4603['ncASJI']===undefined){_0x4603['ncASJI']=!![];}_0x129f12=_0x4603['bLSJOI'](_0x129f12,_0x308b10);_0x4603['LarsXy'][_0x179519]=_0x129f12;}else{_0x129f12=_0x4f9c11;}return _0x129f12;};let RToolurl=$[_0x4603('0','4UCP')](_0x4603('1','LjIx'));let RToolhd=$[_0x4603('2','gayH')](_0x4603('3','%qcc'));let _eid='';let Rtoken=($[_0x4603('4','Y@3Z')]()?process[_0x4603('5','QBGV')][_0x4603('6','%qcc')]:$[_0x4603('7','bre)')](_0x4603('8','LjIx')))||'';let _referer='';let RtokenArr='';let getmsgArr='';let msg_field_name=[];let msg_field_key=[];let msg_field_value=[];!(async()=>{var _0x4e5f91={'SLCRm':function(_0x49f0e2,_0x2dd3d0){return _0x49f0e2==_0x2dd3d0;},'WTArG':function(_0x313396,_0x742335){return _0x313396<_0x742335;},'MkxrX':function(_0x1d0c11,_0x5a9b74){return _0x1d0c11!==_0x5a9b74;},'souJH':_0x4603('9',']1Kq'),'RnuUk':function(_0x3bc9b0){return _0x3bc9b0();},'OWihj':function(_0x1aa94a){return _0x1aa94a();},'xIwWa':_0x4603('a','vf]L'),'FHiQz':function(_0x47ec78,_0x11dff5){return _0x47ec78*_0x11dff5;},'vhxCg':function(_0x498216,_0x124a40){return _0x498216*_0x124a40;},'WqLja':function(_0x345d55,_0x558829){return _0x345d55*_0x558829;},'fAvoG':function(_0xd266ac,_0x28e38a,_0x2f43bc){return _0xd266ac(_0x28e38a,_0x2f43bc);},'QWxPt':function(_0x519b7){return _0x519b7();},'vHiYz':function(_0x26ef33,_0x356fb0){return _0x26ef33!==_0x356fb0;},'pthaj':function(_0x4ace6b,_0x53ae90){return _0x4ace6b+_0x53ae90;}};if(_0x4e5f91[_0x4603('b','YtZd')](typeof $request,_0x4e5f91[_0x4603('c','Rxp!')])){_0x4e5f91[_0x4603('d','x#PM')](RToolck);_0x4e5f91[_0x4603('e','gayH')](RTck);}else{if(_0x4e5f91[_0x4603('f','RhaA')](_0x4e5f91[_0x4603('10','5QDQ')],_0x4603('a','vf]L'))){let _0x2b669d=index+0x1;console[_0x4603('11',')XC6')](_0x4603('12','ZcaQ')+_0x2b669d+_0x4603('13','G)%R'));Rtoken=RtokenArr[index];}else{console[_0x4603('14','PcwL')](_0x4603('15','rVcS')+new Date(new Date()[_0x4603('16','Mm8]')]()+_0x4e5f91[_0x4603('17','!dGX')](new Date()[_0x4603('18','xpMc')](),0x3c)*0x3e8+_0x4e5f91[_0x4603('19','8F0O')](_0x4e5f91[_0x4603('1a','%kda')](_0x4e5f91[_0x4603('1b','0u0!')](0x8,0x3c),0x3c),0x3e8))[_0x4603('1c','q&bz')]()+_0x4603('1d','Z7uO'));RtokenArr=await _0x4e5f91[_0x4603('1e','Z7uO')](checkEnv,Rtoken,_0x4603('1f','!T$1'));console[_0x4603('14','PcwL')](_0x4603('20','Kf&p')+RtokenArr[_0x4603('21','k&F[')]+_0x4603('22','#phY'));console[_0x4603('23','rVcS')](_0x4603('24','byY8')+RtokenArr);await _0x4e5f91[_0x4603('25','*AKg')](getkey);for(let _0x4df10e=0x0;_0x4df10e<0x1;_0x4df10e++){if(_0x4e5f91[_0x4603('26','ZcaQ')](_0x4603('27',']1Kq'),_0x4603('28','oMTA'))){data=JSON[_0x4603('29','byY8')](data);if(_0x4e5f91[_0x4603('2a','gayH')](data[_0x4603('2b','YtZd')],_0x4603('2c','Mm8]'))){console[_0x4603('2d',')Z@o')](_0x4603('2e','q&bz'));}let _0xd233f2=data[_0x4603('2f',')Z@o')][_0x4603('30','669T')];getmsgArr=_0xd233f2[_0x4603('31','W5sp')];console[_0x4603('2d',')Z@o')](_0x4603('32','Kf&p')+getmsgArr+_0x4603('33','HBvK'));for(let _0x40ead3=0x0;_0x4e5f91[_0x4603('34','Y@3Z')](_0x40ead3,getmsgArr);_0x40ead3++){msg_field_name[_0x40ead3]=_0xd233f2[_0x40ead3][_0x4603('35','5QDQ')];msg_field_key[_0x40ead3]=_0xd233f2[_0x40ead3][_0x4603('36','NiwL')];}console[_0x4603('37','%kda')](_0x4603('38','669T')+msg_field_name);let _0x59cb6d=data[_0x4603('39','G)%R')][_0x4603('3a','W5sp')];console[_0x4603('3b','g$D]')](_0x4603('3c','LjIx')+_0x59cb6d);}else{let _0x39ce65=_0x4e5f91[_0x4603('3d','[UNn')](_0x4df10e,0x1);console[_0x4603('3e','669T')](_0x4603('3f','g$D]')+_0x39ce65+_0x4603('40','k&F['));Rtoken=RtokenArr[_0x4df10e];}}}}})()[_0x4603('41','8F0O')](_0x858c67=>$[_0x4603('42','rVcS')](_0x858c67))[_0x4603('43','RhaA')](()=>$[_0x4603('44','oMTA')]());function getkey(_0x5ddc9f=0x0){var _0x48c127={'LbTcg':_0x4603('45','k&F['),'hyvMO':function(_0x811dbc,_0x9918b8){return _0x811dbc==_0x9918b8;},'lMoHv':_0x4603('46','YtZd'),'KandE':function(_0x348ddb,_0x5f780a){return _0x348ddb===_0x5f780a;},'GHLqi':_0x4603('47','NiwL'),'EZmJK':_0x4603('48','hVc('),'JicIm':function(_0x456fa3,_0x2defad){return _0x456fa3<_0x2defad;},'ByIBZ':function(_0x4a98da){return _0x4a98da();},'JEkNu':function(_0x2d03c3,_0x254e77){return _0x2d03c3!==_0x254e77;},'UJHoR':_0x4603('49','RhaA')};return new Promise(_0x915751=>{if(_0x48c127[_0x4603('4a','q&bz')](_0x48c127[_0x4603('4b','%qcc')],_0x48c127[_0x4603('4c','Rxp!')])){ckArr[_0x4603('4d','!15s')](ck);}else{_eid=RToolurl[_0x4603('4e','[UNn')](/eid=(.*?)&/)[0x1];let _0x6100f0={'url':_0x4603('4f','oMTA')+_eid+_0x4603('50','k&F[')+RtokenArr[0x0]+_0x4603('51','%qcc'),'headers':JSON[_0x4603('52','0u0!')](RToolhd)};$[_0x4603('53','q&bz')](_0x6100f0,async(_0x25276a,_0x289f0d,_0x53c8be)=>{var _0x2f58d3={'mCNPM':function(_0x3ee633){return _0x3ee633();},'fEAPW':function(_0x2c4fa5){return _0x2c4fa5();}};if(_0x4603('54','VJ8f')!==_0x48c127[_0x4603('55','LjIx')]){ck[_0x4603('56','!dGX')]('@')[_0x4603('57','PcwL')](_0x299cc4=>{ckArr[_0x4603('58','vf]L')](_0x299cc4);});}else{try{_0x53c8be=JSON[_0x4603('59','xauj')](_0x53c8be);if(_0x48c127[_0x4603('5a','gayH')](_0x53c8be[_0x4603('5b','Y@3Z')],_0x48c127[_0x4603('5c','xpMc')])){if(_0x48c127[_0x4603('5d','xpMc')](_0x48c127[_0x4603('5e','PcwL')],_0x48c127[_0x4603('5f','x#PM')])){_0x2f58d3[_0x4603('60','QBGV')](RToolck);_0x2f58d3[_0x4603('61','$AS&')](RTck);}else{console[_0x4603('62','xauj')](_0x4603('63','ZcaQ'));}}let _0x30e12c=_0x53c8be[_0x4603('64','xpMc')][_0x4603('65','RhaA')];getmsgArr=_0x30e12c[_0x4603('66','VJ8f')];console[_0x4603('67','4UCP')](_0x4603('68','Np0U')+getmsgArr+_0x4603('69','#phY'));for(let _0x56372a=0x0;_0x48c127[_0x4603('6a',')Z@o')](_0x56372a,getmsgArr);_0x56372a++){msg_field_name[_0x56372a]=_0x30e12c[_0x56372a][_0x4603('6b','8F0O')];msg_field_key[_0x56372a]=_0x30e12c[_0x56372a][_0x4603('6c','g$D]')];}console[_0x4603('6d','Kf&p')](_0x4603('6e','VJ8f')+msg_field_name);let _0x1ee3e3=_0x53c8be[_0x4603('6f','Np0U')][_0x4603('70','%kda')];console[_0x4603('71','k&F[')](_0x4603('72','oMTA')+_0x1ee3e3);}catch(_0x2b16d0){}finally{_0x48c127[_0x4603('73','hVc(')](_0x915751);}}},_0x5ddc9f);}});}async function checkEnv(_0xcee5d5,_0x4d8561){var _0x329a76={'ksIIk':function(_0x2b98dc,_0x276edb){return _0x2b98dc===_0x276edb;},'Eejwy':_0x4603('74','[UNn'),'NMRJt':function(_0x3ab25b,_0x7c9344){return _0x3ab25b!==_0x7c9344;},'YtgOw':_0x4603('75','vf]L')};return new Promise(_0x569c0f=>{let _0x39bd03=[];if(_0xcee5d5){if(_0x329a76[_0x4603('76','Y@3Z')](_0x329a76[_0x4603('77','k&F[')],_0x4603('78','4UCP'))){_0x39bd03[_0x4603('79','669T')](item);}else{if(_0x329a76[_0x4603('7a','$AS&')](_0xcee5d5[_0x4603('7b','^ait')]('@'),-0x1)){_0xcee5d5[_0x4603('7c',']1Kq')]('@')[_0x4603('7d','#phY')](_0x5c06a6=>{_0x39bd03[_0x4603('7e','%qcc')](_0x5c06a6);});}else if(_0xcee5d5[_0x4603('7f','YtZd')]('\x0a')!==-0x1){_0xcee5d5[_0x4603('80','669T')]('\x0a')[_0x4603('81','g$D]')](_0x1f6727=>{_0x39bd03[_0x4603('82','bre)')](_0x1f6727);});}else{if(_0x329a76[_0x4603('83','QBGV')]!==_0x329a76[_0x4603('84','k&F[')]){_0x569c0f();}else{_0x39bd03[_0x4603('85','YtZd')](_0xcee5d5);}}_0x569c0f(_0x39bd03);}}else{if(_0x4603('86','VJ8f')!==_0x4603('87',')XC6')){console[_0x4603('88','[UNn')]('\x20'+$[_0x4603('89',')XC6')]+_0x4603('8a','gayH')+_0x4d8561+_0x4603('8b','xpMc'));}else{_0xcee5d5[_0x4603('8c','RhaA')]('\x0a')[_0x4603('8d','k&F[')](_0x47a1e7=>{_0x39bd03[_0x4603('8e','Np0U')](_0x47a1e7);});}}});};_0xodc='jsjiami.com.v6';
function Env(t, e) { class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `\ud83d\udd14${this.name}, \u5f00\u59cb!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), a = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(a, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t) { let e = { "M+": (new Date).getMonth() + 1, "d+": (new Date).getDate(), "H+": (new Date).getHours(), "m+": (new Date).getMinutes(), "s+": (new Date).getSeconds(), "q+": Math.floor(((new Date).getMonth() + 3) / 3), S: (new Date).getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, ((new Date).getFullYear() + "").substr(4 - RegExp.$1.length))); for (let s in e) new RegExp("(" + s + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? e[s] : ("00" + e[s]).substr(("" + e[s]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))); let h = ["", "==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="]; h.push(e), s && h.push(s), i && h.push(i), console.log(h.join("\n")), this.logs = this.logs.concat(h) } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t.stack) : this.log("", `\u2757\ufe0f${this.name}, \u9519\u8bef!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }